<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Dunciad Visualizations â€“ makegraphs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Dunciad Visualizations</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Graphs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../notebooks/MakeGraphs.html" aria-current="page">
 <span class="menu-text">Notebook</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import-libraries" id="toc-import-libraries" class="nav-link active" data-scroll-target="#import-libraries">Import Libraries</a></li>
  <li><a href="#config" id="toc-config" class="nav-link" data-scroll-target="#config">Config</a></li>
  <li><a href="#get-raw-data" id="toc-get-raw-data" class="nav-link" data-scroll-target="#get-raw-data">Get Raw Data</a>
  <ul class="collapse">
  <li><a href="#clean-up-columns" id="toc-clean-up-columns" class="nav-link" data-scroll-target="#clean-up-columns">Clean up columns</a></li>
  <li><a href="#clean-up-values" id="toc-clean-up-values" class="nav-link" data-scroll-target="#clean-up-values">Clean up values</a></li>
  <li><a href="#normalize-names" id="toc-normalize-names" class="nav-link" data-scroll-target="#normalize-names">Normalize names</a></li>
  </ul></li>
  <li><a href="#extract-relations" id="toc-extract-relations" class="nav-link" data-scroll-target="#extract-relations">Extract Relations</a></li>
  <li><a href="#extract-nodes" id="toc-extract-nodes" class="nav-link" data-scroll-target="#extract-nodes">Extract Nodes</a></li>
  <li><a href="#extract-edges" id="toc-extract-edges" class="nav-link" data-scroll-target="#extract-edges">Extract Edges</a></li>
  <li><a href="#save-data" id="toc-save-data" class="nav-link" data-scroll-target="#save-data">Save Data</a></li>
  <li><a href="#draw-graphs" id="toc-draw-graphs" class="nav-link" data-scroll-target="#draw-graphs">Draw Graphs</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="import-libraries" class="level1">
<h1>Import Libraries</h1>
<div class="cell" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="config" class="level1">
<h1>Config</h1>
<div class="cell" data-tags="[]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_dir <span class="op">=</span> <span class="st">"data"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>image_dir <span class="op">=</span> <span class="st">"images"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-raw-data" class="level1">
<h1>Get Raw Data</h1>
<div class="cell" data-tags="[]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2020 data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>edges <span class="op">=</span> pd.read_csv(<span class="ss">f"</span><span class="sc">{</span>data_dir<span class="sc">}</span><span class="ss">/2020/edges.csv"</span>)[[<span class="st">'person'</span>,<span class="st">'referent'</span>,<span class="st">'relation'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>edges</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>person</th>
      <th>referent</th>
      <th>relation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Colley Cibber</td>
      <td>Alexander Pope</td>
      <td>Attacked</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Colley Cibber</td>
      <td>Alexander Pope</td>
      <td>Attacked</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Colley Cibber</td>
      <td>John Dennis</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Colley Cibber</td>
      <td>Lewis Theobald</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Colley Cibber</td>
      <td>Stephen Duck</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>341</th>
      <td>John Henley</td>
      <td>John Toland</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>342</th>
      <td>John Henley</td>
      <td>Matthew Tindal</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>343</th>
      <td>John Henley</td>
      <td>Thomas Woolston</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>344</th>
      <td>John Henley</td>
      <td>Thomas Sherlock</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>345</th>
      <td>John Henley</td>
      <td>Leonard Welsted</td>
      <td>Akin to</td>
    </tr>
  </tbody>
</table>
<p>346 rows Ã— 3 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New data -- Seems to be missing Eliza Haywood (Heywood?)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># excel_file = "data/word_docs/ALL.xls"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sheets = []</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># keep_cols = ["character", "person_referred_to", "relation"]</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(5):</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     sheet = pd.read_excel(excel_file, sheet_name=i) </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     sheet.columns = [col.strip().lower().replace(' ', '_') for col in sheet.columns]</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     sheets.append(sheet[keep_cols])</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># edges = pd.concat(sheets)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="clean-up-columns" class="level2">
<h2 class="anchored" data-anchor-id="clean-up-columns">Clean up columns</h2>
<div class="cell" data-tags="[]" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For new data only</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># edges = edges.rename(columns={'character':'person', 'person_referred_to':'referent'})</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># edges = edges.dropna(subset=['person','referent']).copy()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>edges</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>person</th>
      <th>referent</th>
      <th>relation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Colley Cibber</td>
      <td>Alexander Pope</td>
      <td>Attacked</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Colley Cibber</td>
      <td>Alexander Pope</td>
      <td>Attacked</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Colley Cibber</td>
      <td>John Dennis</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Colley Cibber</td>
      <td>Lewis Theobald</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Colley Cibber</td>
      <td>Stephen Duck</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>341</th>
      <td>John Henley</td>
      <td>John Toland</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>342</th>
      <td>John Henley</td>
      <td>Matthew Tindal</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>343</th>
      <td>John Henley</td>
      <td>Thomas Woolston</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>344</th>
      <td>John Henley</td>
      <td>Thomas Sherlock</td>
      <td>Akin to</td>
    </tr>
    <tr>
      <th>345</th>
      <td>John Henley</td>
      <td>Leonard Welsted</td>
      <td>Akin to</td>
    </tr>
  </tbody>
</table>
<p>346 rows Ã— 3 columns</p>
</div>
</div>
</div>
</section>
<section id="clean-up-values" class="level2">
<h2 class="anchored" data-anchor-id="clean-up-values">Clean up values</h2>
<div class="cell" data-tags="[]" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For new data only</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for col in edges.columns:</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     edges[col] = edges[col].str.strip()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>edges[<span class="st">'relation_id'</span>] <span class="op">=</span> edges[<span class="st">'relation'</span>].<span class="bu">str</span>.lower().<span class="bu">str</span>.replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>edges</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>person</th>
      <th>referent</th>
      <th>relation</th>
      <th>relation_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Colley Cibber</td>
      <td>Alexander Pope</td>
      <td>Attacked</td>
      <td>attacked</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Colley Cibber</td>
      <td>Alexander Pope</td>
      <td>Attacked</td>
      <td>attacked</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Colley Cibber</td>
      <td>John Dennis</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Colley Cibber</td>
      <td>Lewis Theobald</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Colley Cibber</td>
      <td>Stephen Duck</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>341</th>
      <td>John Henley</td>
      <td>John Toland</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>342</th>
      <td>John Henley</td>
      <td>Matthew Tindal</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>343</th>
      <td>John Henley</td>
      <td>Thomas Woolston</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>344</th>
      <td>John Henley</td>
      <td>Thomas Sherlock</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>345</th>
      <td>John Henley</td>
      <td>Leonard Welsted</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
  </tbody>
</table>
<p>346 rows Ã— 4 columns</p>
</div>
</div>
</div>
</section>
<section id="normalize-names" class="level2">
<h2 class="anchored" data-anchor-id="normalize-names">Normalize names</h2>
<div class="cell" data-tags="[]" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For new data only</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># edges.loc[edges.person.str.contains(','), 'person'] = edges\</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     .loc[edges.person.str.contains(',')]\</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     .person.apply(lambda x: f"{x.split(',')[1].strip()} {x.split(',')[0]}")</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># edges.loc[edges.person == 'Edmund Curl', 'person'] = 'Edmund Curll' </span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># edges.loc[edges.person == 'Curll Edmund', 'person'] = 'Edmund Curll' </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>edges.person.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>person
Edmund Curll     124
John Dennis      107
Colley Cibber     74
Giles Jacob       20
John Henley       12
Eliza Haywood      9
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>edges</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>person</th>
      <th>referent</th>
      <th>relation</th>
      <th>relation_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Colley Cibber</td>
      <td>Alexander Pope</td>
      <td>Attacked</td>
      <td>attacked</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Colley Cibber</td>
      <td>Alexander Pope</td>
      <td>Attacked</td>
      <td>attacked</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Colley Cibber</td>
      <td>John Dennis</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Colley Cibber</td>
      <td>Lewis Theobald</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Colley Cibber</td>
      <td>Stephen Duck</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>341</th>
      <td>John Henley</td>
      <td>John Toland</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>342</th>
      <td>John Henley</td>
      <td>Matthew Tindal</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>343</th>
      <td>John Henley</td>
      <td>Thomas Woolston</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>344</th>
      <td>John Henley</td>
      <td>Thomas Sherlock</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
    <tr>
      <th>345</th>
      <td>John Henley</td>
      <td>Leonard Welsted</td>
      <td>Akin to</td>
      <td>akin_to</td>
    </tr>
  </tbody>
</table>
<p>346 rows Ã— 4 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># edges.loc[edges.referent.str.contains(','), 'referent'] = edges.loc[edges.referent.str.contains(',')].referent.apply(lambda x: f"{x.split(',')[1].strip()} {x.split(',')[0]}")</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># edges.loc[edges.referent == 'Edmund Curl', 'referent'] = 'Edmund Curll' </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(edges.referent.value_counts().sort_index().index.to_list()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A Boyer
A Moore
Abel Evans
Abel Roper
Alexander Pope
Ambrose Phillips
Anne Tanneguy-Le Fevre Dacier
B.B.
Barton Booth
Bavius
Benjamin Hoadly
Bernard Lintot
Besaleel Morris
Caius Gabriel Cibber
Camillo Querno
Cardell Goodman
Charles Fleetwood
Charles Gildon
Cloacina
Colley Cibber
Daniel Defoe
Dulness
Edmund Curll
Edmund Gibson
Edward Ward
Edward Young
Elisha Kirkall
Eliza Haywood
Elizabeth Thomas
Elkanah Settle
Eustace Budgell
Frances Hare
Francis Atterbury
George Ducket
George Duckett
George Etherege
George I
George II
George Ridpath
Giles Jacob
Henry Cromwell
Henry Curll
Henry Janssen
Hilkiah Bedford
Isaac Barrow
Isaac Newton
Issac Barrow
James Moore Smythe
James Ralph
James-Moore Smith
Jeremy Collier
John Anstis
John Arbuthnot
John Atterbury
John Banks
John Dennis
John Dryden
John Dunton
John Durant Breval
John Fletcher
John Garth
John Gay
John Henley
John Hervey
John Locke
John Oldmixon
John Ozell
John Toland
John Tutchin
Jonathan Swift
Joseph Addison
Joseph Gay
Joseph Gay (aka John Durant Breval)
Lady Mary Wortley Montagu
Laurence Eusden
Leonard Welsted
Lewis Theobald
Lord Bishop of London
Martinus Scriblerus
Matthew Concanen
Matthew Prior
Matthew Tindal
Philip Dormer Stanhope
Richard Bentley
Richard Blackmore
Richard Flecknoe
Richard Savage
Robert Walpole
S Popping
Samuel Garth
Stephen Duck
Susanna Centlivre
Thomas Archer
Thomas Cooke
Thomas Osborne
Thomas Rymer
Thomas Sherlock
Thomas Warner
Thomas Woolston
Tom DÃ­Urfey
Toussaint Edmond de Saint-Mard
White Kenneth
William Bond
William Bond 
William Broome
William Cavendish
William Congreve
William Law
William Mears
William Temple
William Wilkins
William Wycherley</code></pre>
</div>
</div>
</section>
</section>
<section id="extract-relations" class="level1">
<h1>Extract Relations</h1>
<div class="cell" data-tags="[]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> edges.value_counts(<span class="st">'relation_id'</span>).to_frame(<span class="st">'n'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>R[<span class="st">'color'</span>] <span class="op">=</span> [<span class="st">'green'</span>,<span class="st">'red'</span>,<span class="st">'orange'</span>,<span class="st">'blue'</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>R[<span class="st">'label'</span>] <span class="op">=</span> R.index.<span class="bu">str</span>.replace(<span class="st">'_'</span>, <span class="st">' '</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>n</th>
      <th>color</th>
      <th>label</th>
    </tr>
    <tr>
      <th>relation_id</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>akin_to</th>
      <td>189</td>
      <td>green</td>
      <td>akin to</td>
    </tr>
    <tr>
      <th>attacked</th>
      <td>113</td>
      <td>red</td>
      <td>attacked</td>
    </tr>
    <tr>
      <th>dissimilar</th>
      <td>25</td>
      <td>orange</td>
      <td>dissimilar</td>
    </tr>
    <tr>
      <th>defended</th>
      <td>19</td>
      <td>blue</td>
      <td>defended</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="extract-nodes" class="level1">
<h1>Extract Nodes</h1>
<div class="cell" data-tags="[]" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> pd.concat([edges.person, edges.referent]).value_counts().to_frame(<span class="st">'n'</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> N.reset_index().rename(columns<span class="op">=</span>{<span class="st">'index'</span>:<span class="st">'full_name'</span>})</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>N[<span class="st">'index'</span>] <span class="op">=</span> N[<span class="st">'full_name'</span>].<span class="bu">str</span>.replace(<span class="st">' '</span>, <span class="st">'_'</span>).<span class="bu">str</span>.upper().<span class="bu">str</span>.replace(<span class="vs">r"\W"</span>, <span class="st">""</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> N.set_index(<span class="st">'index'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create label by splitting middle space of name</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> N.full_name.<span class="bu">str</span>.split(<span class="st">' '</span>).to_frame(<span class="st">'list'</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>X[<span class="st">'offset'</span>] <span class="op">=</span> np.<span class="bu">round</span>(X[<span class="st">'list'</span>].<span class="bu">apply</span>(<span class="bu">len</span>) <span class="op">/</span> <span class="dv">2</span>).astype(<span class="st">'int'</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>X[<span class="st">'label'</span>] <span class="op">=</span> X.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.<span class="bu">list</span>[:x.offset] <span class="op">+</span> [<span class="st">"&lt;br/&gt;"</span>] <span class="op">+</span> x.<span class="bu">list</span>[x.offset:], axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">apply</span>(<span class="st">' '</span>.join)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>X[<span class="st">'label'</span>] <span class="op">=</span> X[<span class="st">'label'</span>].<span class="bu">str</span>.replace(<span class="vs">r"^\s*&lt;br/&gt;\s*"</span>, <span class="st">""</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>X[<span class="st">'label'</span>] <span class="op">=</span> X[<span class="st">'label'</span>].<span class="bu">str</span>.replace(<span class="vs">r"\s*&lt;br/&gt;\s*"</span>, <span class="st">"&lt;br/&gt;"</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> N.join(X.label)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>N.label.sort_values() <span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>index
A_BOYER                        A&lt;br/&gt;Boyer
A_MOORE                        A&lt;br/&gt;Moore
ABEL_EVANS                  Abel&lt;br/&gt;Evans
ABEL_ROPER                  Abel&lt;br/&gt;Roper
ALEXANDER_POPE          Alexander&lt;br/&gt;Pope
                             ...          
WILLIAM_LAW                William&lt;br/&gt;Law
WILLIAM_MEARS            William&lt;br/&gt;Mears
WILLIAM_TEMPLE          William&lt;br/&gt;Temple
WILLIAM_WILKINS        William&lt;br/&gt;Wilkins
WILLIAM_WYCHERLEY    William&lt;br/&gt;Wycherley
Name: label, Length: 112, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># N['label'] = N['full_name'].str.replace(' ', '&lt;br/&gt;')</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>N[<span class="st">'dot'</span>] <span class="op">=</span> N.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"</span><span class="sc">{</span>x<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> [label=&lt; </span><span class="sc">{</span>x<span class="sc">.</span>label<span class="sc">}</span><span class="ss"> &gt;]"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>N.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>full_name</th>
      <th>n</th>
      <th>label</th>
      <th>dot</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>EDMUND_CURLL</th>
      <td>Edmund Curll</td>
      <td>131</td>
      <td>Edmund&lt;br/&gt;Curll</td>
      <td>EDMUND_CURLL [label=&lt; Edmund&lt;br/&gt;Curll &gt;]</td>
    </tr>
    <tr>
      <th>JOHN_DENNIS</th>
      <td>John Dennis</td>
      <td>122</td>
      <td>John&lt;br/&gt;Dennis</td>
      <td>JOHN_DENNIS [label=&lt; John&lt;br/&gt;Dennis &gt;]</td>
    </tr>
    <tr>
      <th>ALEXANDER_POPE</th>
      <td>Alexander Pope</td>
      <td>83</td>
      <td>Alexander&lt;br/&gt;Pope</td>
      <td>ALEXANDER_POPE [label=&lt; Alexander&lt;br/&gt;Pope &gt;]</td>
    </tr>
    <tr>
      <th>COLLEY_CIBBER</th>
      <td>Colley Cibber</td>
      <td>78</td>
      <td>Colley&lt;br/&gt;Cibber</td>
      <td>COLLEY_CIBBER [label=&lt; Colley&lt;br/&gt;Cibber &gt;]</td>
    </tr>
    <tr>
      <th>GILES_JACOB</th>
      <td>Giles Jacob</td>
      <td>24</td>
      <td>Giles&lt;br/&gt;Jacob</td>
      <td>GILES_JACOB [label=&lt; Giles&lt;br/&gt;Jacob &gt;]</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="extract-edges" class="level1">
<h1>Extract Edges</h1>
<div class="cell" data-tags="[]" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>edges[<span class="st">'person_id'</span>] <span class="op">=</span> edges.person.<span class="bu">map</span>(N.reset_index().set_index(<span class="st">'full_name'</span>)[<span class="st">'index'</span>])</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>edges[<span class="st">'referent_id'</span>] <span class="op">=</span> edges.referent.<span class="bu">map</span>(N.reset_index().set_index(<span class="st">'full_name'</span>)[<span class="st">'index'</span>])</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># edges['relation_id'] = edges.relation.str.lower().str.replace(' ', '_', regex=True)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>E <span class="op">=</span> edges.groupby([<span class="st">'person_id'</span>,<span class="st">'referent_id'</span>,<span class="st">'relation_id'</span>]).relation_id.count().to_frame(<span class="st">'n'</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>E.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>n</th>
    </tr>
    <tr>
      <th>person_id</th>
      <th>referent_id</th>
      <th>relation_id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">COLLEY_CIBBER</th>
      <th rowspan="2" valign="top">ALEXANDER_POPE</th>
      <th>akin_to</th>
      <td>1</td>
    </tr>
    <tr>
      <th>attacked</th>
      <td>9</td>
    </tr>
    <tr>
      <th>BARTON_BOOTH</th>
      <th>akin_to</th>
      <td>1</td>
    </tr>
    <tr>
      <th>CAIUS_GABRIEL_CIBBER</th>
      <th>akin_to</th>
      <td>2</td>
    </tr>
    <tr>
      <th>CAMILLO_QUERNO</th>
      <th>akin_to</th>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="24">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>E[<span class="st">'dot'</span>] <span class="op">=</span> E.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"</span><span class="sc">{</span>x<span class="sc">.</span>name[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span>x<span class="sc">.</span>name[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> [color=</span><span class="sc">{</span>R<span class="sc">.</span>loc[x.name[<span class="dv">2</span>], <span class="st">'color'</span>]<span class="sc">}</span><span class="ss"> weight=</span><span class="sc">{</span>x<span class="sc">.</span>n<span class="op">**</span><span class="dv">2</span><span class="sc">}</span><span class="ss">]"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="25">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>E</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>n</th>
      <th>dot</th>
    </tr>
    <tr>
      <th>person_id</th>
      <th>referent_id</th>
      <th>relation_id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">COLLEY_CIBBER</th>
      <th rowspan="2" valign="top">ALEXANDER_POPE</th>
      <th>akin_to</th>
      <td>1</td>
      <td>COLLEY_CIBBER -&gt; ALEXANDER_POPE [color=green w...</td>
    </tr>
    <tr>
      <th>attacked</th>
      <td>9</td>
      <td>COLLEY_CIBBER -&gt; ALEXANDER_POPE [color=red wei...</td>
    </tr>
    <tr>
      <th>BARTON_BOOTH</th>
      <th>akin_to</th>
      <td>1</td>
      <td>COLLEY_CIBBER -&gt; BARTON_BOOTH [color=green wei...</td>
    </tr>
    <tr>
      <th>CAIUS_GABRIEL_CIBBER</th>
      <th>akin_to</th>
      <td>2</td>
      <td>COLLEY_CIBBER -&gt; CAIUS_GABRIEL_CIBBER [color=g...</td>
    </tr>
    <tr>
      <th>CAMILLO_QUERNO</th>
      <th>akin_to</th>
      <td>2</td>
      <td>COLLEY_CIBBER -&gt; CAMILLO_QUERNO [color=green w...</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">JOHN_HENLEY</th>
      <th>MATTHEW_TINDAL</th>
      <th>akin_to</th>
      <td>1</td>
      <td>JOHN_HENLEY -&gt; MATTHEW_TINDAL [color=green wei...</td>
    </tr>
    <tr>
      <th>RICHARD_BLACKMORE</th>
      <th>akin_to</th>
      <td>1</td>
      <td>JOHN_HENLEY -&gt; RICHARD_BLACKMORE [color=green ...</td>
    </tr>
    <tr>
      <th>RICHARD_FLECKNOE</th>
      <th>akin_to</th>
      <td>1</td>
      <td>JOHN_HENLEY -&gt; RICHARD_FLECKNOE [color=green w...</td>
    </tr>
    <tr>
      <th>THOMAS_SHERLOCK</th>
      <th>akin_to</th>
      <td>1</td>
      <td>JOHN_HENLEY -&gt; THOMAS_SHERLOCK [color=green we...</td>
    </tr>
    <tr>
      <th>THOMAS_WOOLSTON</th>
      <th>akin_to</th>
      <td>1</td>
      <td>JOHN_HENLEY -&gt; THOMAS_WOOLSTON [color=green we...</td>
    </tr>
  </tbody>
</table>
<p>172 rows Ã— 2 columns</p>
</div>
</div>
</div>
</section>
<section id="save-data" class="level1">
<h1>Save Data</h1>
<div class="cell" data-tags="[]" data-execution_count="86">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>N.to_csv(<span class="st">"data/2020/mod/N.csv"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>E.to_csv(<span class="st">"data/2020/mod/E.csv"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>R.to_csv(<span class="st">"data/2020/mod/R.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="draw-graphs" class="level1">
<h1>Draw Graphs</h1>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_graph(persons:[]<span class="op">=</span>[], engines<span class="op">=</span>[<span class="st">'sfdp'</span>,<span class="st">'circo'</span>], verbose<span class="op">=</span><span class="va">True</span>, width<span class="op">=</span><span class="dv">2000</span>):</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> E, N    </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create subsets of N and E</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    E1 <span class="op">=</span> E.loc[persons] <span class="cf">if</span> <span class="bu">len</span>(persons) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> E</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    node_idx <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(persons <span class="op">+</span> E1.reset_index()[<span class="st">'referent_id'</span>].to_list()))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    N1 <span class="op">=</span> N.loc[node_idx].sort_index()</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to Graphviz</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    graph_text <span class="op">=</span> <span class="st">"digraph G {</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    graph_text <span class="op">+=</span> <span class="st">"rankdir=LR</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    graph_text <span class="op">+=</span> <span class="st">"node [shape=rect overlap=false fontname=arial]</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    graph_text <span class="op">+=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(N1[<span class="st">'dot'</span>].values)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    graph_text <span class="op">+=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    graph_text <span class="op">+=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(E1[<span class="st">'dot'</span>].values)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    graph_text <span class="op">+=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">}"</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print source to file</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    file_name <span class="op">=</span> <span class="st">'_'</span>.join(persons) <span class="op">+</span> <span class="st">".dot"</span> <span class="cf">if</span> <span class="bu">len</span>(persons) <span class="cf">else</span> <span class="st">"images/all.dot"</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    file_name <span class="op">=</span> image_dir <span class="op">+</span> <span class="st">"/"</span> <span class="op">+</span> file_name</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> verbose:</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(file_name)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(file_name, <span class="st">"w"</span>) <span class="im">as</span> outfile:</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>        outfile.write(graph_text)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate images</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> engine <span class="kw">in</span> engines:</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to SVG</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        os.system(<span class="ss">f"</span><span class="sc">{</span>engine<span class="sc">}</span><span class="ss"> -Tsvg </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss"> &gt; </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>engine<span class="sc">}</span><span class="ss">.svg"</span>)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to PNG</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        os.system(<span class="ss">f"rsvg-convert -w </span><span class="sc">{</span>width<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>engine<span class="sc">}</span><span class="ss">.svg &gt; </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>engine<span class="sc">}</span><span class="ss">_w</span><span class="sc">{</span>width<span class="sc">}</span><span class="ss">.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="27">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>persons <span class="op">=</span> E.index.levels[<span class="dv">0</span>].to_list()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="28">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>create_graph(persons)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> person <span class="kw">in</span> persons:</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    create_graph([person])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>images/COLLEY_CIBBER_EDMUND_CURLL_ELIZA_HAYWOOD_GILES_JACOB_JOHN_DENNIS_JOHN_HENLEY.dot
images/COLLEY_CIBBER.dot
images/EDMUND_CURLL.dot
images/ELIZA_HAYWOOD.dot
images/GILES_JACOB.dot
images/JOHN_DENNIS.dot
images/JOHN_HENLEY.dot</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>